<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Discover - Bloom & Rise</title>
  <link href="https://fonts.googleapis.com/css2?family=Alice&family=Lora:wght@300;400&display=swap" rel="stylesheet" />
  <style>
    body {
      background-color: #1A2421;
      color: #fff8d2;
      font-family: 'Lora', serif;
      padding: 60px 20px 40px;
      text-align: center;
      min-height: 100vh;
      margin: 0;
      position: relative;
    }

    .brand-name-discover {
      font-family: 'Alice', serif;
      font-size: 40px;
      color: #d4af37;
      letter-spacing: 8px;
      margin: 15px 0 60px;
    }

    /* زر الرجوع الذهبي */
    .back-button {
      position: absolute;
      top: 15px;
      left: 20px;
      font-size: 25px;
      color: #d4af37;
      text-shadow:
        0 0 8px #f5d061,
        0 0 15px #d4af37,
        0 0 20px #f5d061;
      text-decoration: none;
      background: none;
      padding: 0;
      border: none;
      cursor: pointer;
      user-select: none;
      transition: transform 0.15s ease, color 0.15s ease, text-shadow 0.3s ease;
      display: inline-block;
      z-index: 10;
    }
    .back-button:hover {
      transform: scale(1.1);
      text-shadow:
        0 0 12px #f5d061,
        0 0 20px #d4af37,
        0 0 30px #f5d061;
      color: #f5d061;
    }
    .back-button:active {
      transform: scale(0.85);
      color: #d4af37;
      text-shadow:
        0 0 10px #d4af37,
        0 0 15px #f5d061;
    }

    /* Disclosure toggle (نجمة التصريح) */
    .disclosure-toggle {
      position: absolute;
      top: 15px;
      right: 18px;
      width: 24px;
      height: 24px;
      background-color: transparent;
      border: none;
      cursor: pointer;
      z-index: 10;
      animation: floatUpDown 2s infinite ease-in-out;
    }
    .disclosure-toggle::before {
      content: "ℬ";
      font-size: 22px;
      color: #ffffff;
      text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
      display: block;
      transition: transform 0.3s ease, text-shadow 0.3s ease;
    }
    .disclosure-toggle:hover::before {
      transform: scale(1.1);
      text-shadow: 0 0 12px rgba(255, 255, 255, 1);
    }

    @keyframes floatUpDown {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-2px);
      }
    }

    /* Disclosure text */
    .disclosure-text {
      max-width: 700px;
      margin: 100px auto 0;
      font-size: 15px;
      color: #fff8d2;
      background-color: rgba(0, 0, 0, 0.25);
      padding: 15px 20px;
      border-radius: 12px;
      line-height: 1.6;
      box-shadow: 0 0 15px rgba(212, 175, 55, 0.8);
      display: none;
      user-select: text;
      text-align: right;
      direction: ltr;
    }

    /* Search bar */
    .search-bar {
      max-width: 400px;
      margin: 0 auto 25px;
    }
    .search-wrapper {
      position: relative;
    }
    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      fill: #d4af37;
      width: 20px;
      height: 20px;
    }
    .search-wrapper input {
      width: 100%;
      padding: 10px 20px 10px 40px; /* space for icon */
      border-radius: 25px;
      border: 2px solid #1a422b; /* أخضر غامق */
      background-color: #1A2421;
      color: #fff8d2;
      font-size: 16px;
      font-family: 'Lora', serif;
      transition: box-shadow 0.3s ease, border-color 0.3s ease;
    }
    .search-wrapper input::placeholder {
      color: #1a422baa; /* أخضر شفاف */
    }
    .search-wrapper input:focus {
      outline: none;
      box-shadow: 0 0 10px 2px #1a422bcc; /* ظل أخضر */
      border-color: #f5d061; /* ذهبي */
    }

    /* Categories */
    .categories {
      margin-bottom: 30px;
    }
    .categories button {
      background: linear-gradient(135deg, #f5d061, #d4af37);
      color: #1A2421;
      font-family: 'Alice', serif;
      padding: 10px 20px;
      margin: 5px;
      border: none;
      border-radius: 20px;
      font-size: 14px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.3s;
    }
    .categories button:hover,
    .categories button.active {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.8);
    }

    /* Results grid */
    .results {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
      gap: 25px;
      max-width: 900px;
      margin: 0 auto;
      text-align: left;
    }
    .product-card {
      background: rgba(212, 175, 55, 0.1);
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
      transition: transform 0.2s;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .product-card:hover {
      transform: scale(1.03);
      box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
    }
    .product-image {
      width: 100%;
      height: 160px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 10px;
      flex-shrink: 0;
    }
    .product-name {
      font-family: 'Alice', serif;
      font-size: 18px;
      color: #d4af37;
      margin: 0 0 8px 0;
      line-height: 1.2;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .product-description {
      font-size: 14px;
      color: #fff8d2cc;
      margin-bottom: 10px;
      max-height: 3em; /* سطرين فقط */
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .product-link {
      display: inline-block;
      background-color: #d4af37;
      color: #1a1a1a;
      padding: 8px 15px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      font-family: 'Alice', serif;
      transition: background-color 0.3s;
      margin-top: auto;
      align-self: flex-start;
    }
    .product-link:hover {
      background-color: #b58d2b;
    }
    .see-more-btn {
      margin-top: 8px;
      background: none;
      border: none;
      color: #f5d061;
      cursor: pointer;
      font-family: 'Alice', serif;
      font-size: 14px;
      text-decoration: underline;
      padding: 0;
      align-self: flex-start;
    }
    .see-more-btn:hover {
      color: #d4af37;
    }

    /* No results */
    .no-results {
      font-size: 18px;
      color: #f5d061cc;
      margin-top: 50px;
      text-align: center;
    }

    /* Responsive for mobile */
    @media (max-width: 768px) {
      .search-bar {
        max-width: 90%;
        margin-bottom: 20px;
      }
      .search-wrapper input {
        font-size: 18px;
        padding: 12px 22px 12px 45px;
      }
      .search-icon {
        width: 22px;
        height: 22px;
        left: 15px;
      }
      .brand-name-discover {
        font-size: 28px;
        letter-spacing: 3px;
        margin: 20px 0 40px;
      }
    }

    /* Modal styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      padding: 20px;
      box-sizing: border-box;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .modal-overlay.show {
      visibility: visible;
      opacity: 1;
    }
    .modal-content {
      background: #272f24;
      color: #fff8d2;
      max-width: 600px;
      width: 100%;
      border-radius: 12px;
      padding: 25px 30px;
      box-shadow: 0 0 30px rgba(212, 175, 55, 0.9);
      position: relative;
      max-height: 80vh;
      overflow-y: auto;
      text-align: right;
      direction: rtl;
      font-family: 'Lora', serif;
    }
    .modal-content h2 {
      font-family: 'Alice', serif;
      color: #d4af37;
      margin-top: 0;
      margin-bottom: 15px;
      text-align: center;
      direction: ltr;
      white-space: normal;
    }
    .modal-images {
      display: flex;
      gap: 12px;
      margin-bottom: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .modal-images img {
      max-height: 100px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
      box-shadow: 0 0 8px rgba(212, 175, 55, 0.7);
      transition: transform 0.2s;
      width: auto;
      max-width: 30%;
    }
    .modal-images img:hover {
      transform: scale(1.1);
    }
    .modal-description {
      font-size: 14px;
      line-height: 1.5;
      margin-bottom: 20px;
      text-align: left;
      direction: ltr;
      color: #fff8d2cc;
      white-space: pre-wrap;
    }
    .modal-shop-button {
      background-color: #d4af37;
      color: #1a1a1a;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: bold;
      font-family: 'Alice', serif;
      text-decoration: none;
      display: block;
      max-width: 200px;
      margin: 0 auto;
      transition: background-color 0.3s;
      text-align: center;
    }
    .modal-shop-button:hover {
      background-color: #b58d2b;
    }
    #modal-close {
      position: absolute;
      top: 10px;
      left: 15px;
      background: none;
      border: none;
      font-size: 30px;
      color: #d4af37;
      cursor: pointer;
      font-weight: bold;
      transition: color 0.3s ease;
    }
    #modal-close:hover {
      color: #f5d061;
    }

  </style>
</head>
<body>

  <!-- زر الرجوع -->
  <a href="index.html" class="back-button" aria-label="Back to home">←</a>

  <!-- نجمة disclosure -->
  <button class="disclosure-toggle" 
          aria-expanded="false" 
          aria-controls="disclosure-text" 
          aria-label="Show Amazon Disclosure">
  </button>

  <!-- نص الإفصاح -->
  <div id="disclosure-text" class="disclosure-text" role="region" aria-live="polite">
    Some links on this site are affiliate links, which means we may earn a commission if you make a purchase through them, at no extra cost to you. We carefully select and recommend only products we trust.
  </div>

  <h1 class="brand-name-discover">B L O O M & R I S E</h1>

  <!-- Search bar -->
  <div class="search-bar">
    <label for="search-input" class="visually-hidden">Search products</label>
    <div class="search-wrapper">
      <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M10 2a8 8 0 105.293 14.293l4.707 4.707 1.414-1.414-4.707-4.707A8 8 0 0010 2zm0 2a6 6 0 110 12 6 6 0 010-12z"/>
      </svg>
      <input type="search" id="search-input" placeholder="Search for a product..." autocomplete="off" />
    </div>
  </div>

  <!-- Categories -->
  <div class="categories" role="list" aria-label="Product categories">
    <!-- Buttons added dynamically -->
  </div>

  <!-- Results -->
  <div class="results" aria-live="polite" aria-atomic="true">
    <!-- Products will appear here -->
  </div>

  <!-- Modal container (hidden by default) -->
  <div id="product-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-product-name" style="display:none;">
    <div class="modal-content">
      <button id="modal-close" aria-label="Close modal">&times;</button>
      <h2 id="modal-product-name"></h2>
      <div id="modal-images" class="modal-images"></div>
      <div id="modal-description" class="modal-description"></div>
      <a id="modal-affiliate-link" href="#" target="_blank" rel="noopener" class="modal-shop-button">Shop Now</a>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch.umd.min.js"></script>

  <script>
    const toggle = document.querySelector('.disclosure-toggle');
    const text = document.getElementById('disclosure-text');

    toggle.addEventListener('mouseenter', () => {
      text.style.display = 'block';
    });

    toggle.addEventListener('mouseleave', () => {
      text.style.display = 'none';
    });

    const APPLICATION_ID = "86N2D6VM5Z";
    const SEARCH_ONLY_API_KEY = "098e6699938861e039baa664b8ce4ef1";
    const INDEX_NAME = "products";

    const client = algoliasearch(APPLICATION_ID, SEARCH_ONLY_API_KEY);
    const index = client.initIndex(INDEX_NAME);

    let categoriesSet = new Set();
    const searchInput = document.getElementById('search-input');
    const categoriesContainer = document.querySelector('.categories');
    const resultsContainer = document.querySelector('.results');
    let activeCategory = null;

    // بيانات إضافية للمنتجات - الصور الإضافية والتفاصيل الكاملة وروابط الأفلييت
    const extraProductData = {
      "Korean Glass Glow Collagen Jelly Cream": {
        extraImages: [
          "https://m.media-amazon.com/images/I/71+OEoOZrDL._SL1500_.jpg",
          "https://m.media-amazon.com/images/I/7143+0DVD-L._SL1500_.jpg"
        ],
        fullDescription: `EVEN OUT UNEVEN SKIN TONE – Unlock the power of a transparent collagen jelly cream designed to specifically target and correct uneven skin tone. Reveal a more harmonious, luminous complexion for a naturally smooth and radiant look
GLASS GLOW SKIN - Discover a transparent collagen jelly cream offering anti-aging benefits. Enhance facial contours, promote firmness, and achieve a polished, glowing complexion effortlessly.
PRODUCT BENEFITS - Instantly experience tightened, radiant skin with the 'Korean Glass Glow' effect post-application. Dermatologist-tested, low-irritating, silicone-free, with a skin-friendly pH of 5.69–7.69 and no artificial colorants.
KEY INGREDIENTS - Hydrolyzed Collagen: Smaller segments enable better skin absorption, preserving firmness and elasticity, and Niacinamide (Vitamin B3) enhances the skin's barrier function and boosts hydration for improved texture.
DERMATOLOGIST TESTED - Skin elasticity 1.793% improved and Sagging skin 2.488% improved after 24hr.
HOW TO APPLY - Apply a quarter amount of jelly cream morning and evening to face and décolletage (neck & chest), after applying targeted serums that address your individual skin concerns.`,
        affiliateLink: "https://amzn.to/4m5Ipoe"
      },
      "Hydrogel Eye Masks": {
        extraImages: [
          "https://m.media-amazon.com/images/I/61Z5pjKIUSL._SL1350_.jpg",
          "https://m.media-amazon.com/images/I/51GlzUeH04L._SL1080_.jpg",
          "https://m.media-amazon.com/images/I/61Ok7HOHIqL._SL1080_.jpg"
        ],
        fullDescription: `Hydrogel Eye Masks for Men & Women: A water-soluble gel-type eye patch with a concentration of high-quality ingredients with non-slip technology for intensive eye care
Hyaluronic Acid: High-quality Hyaluronic Acid, this ingredient is famous for providing a high moisture effect maintaining hydration and vibrant-looking skin, and also creating a protective barrier that holds moisture in throughout the day
Solution for Tired Eyes: Watery solution with an abundance of the essence for intensive care maximizing the treatment in the surface area. Provides a cooling sense, relieves fatigue around the eyes, and hydrates the skin for an anti-aging effect
Provide Nutrition to Areas Around Eyes: Low irritation formula patches, just apply the eye patch between 15-20 minutes and allow your skin to absorb all the ingredients and nutrients to obtain moist, soothing, and more resilient skin
Extra Usage Tip: You can also apply the Hydrogel Patches at the neck, around the mouth & forehead as an anti-wrinkle and dryness solution since they will adhere to any part you apply them to allow the skin to absorb all the ingredients targeting the wish area and obtaining the same benefits listed above`,
        affiliateLink: "https://amzn.to/4okt0lk"
      }
    };

    function renderResults(hits) {
      resultsContainer.innerHTML = '';

      if (hits.length === 0) {
        resultsContainer.innerHTML = `<p class="no-results">No results found</p>`;
        return;
      }

      hits.forEach(item => {
        if (item.category) categoriesSet.add(item.category);

        // Get short description for preview (max 2 lines)
        let shortDesc = item.description || '';
        if (shortDesc.length > 110) {
          shortDesc = shortDesc.slice(0, 110) + '...';
        }

        // See more button only if we have extra data
        const hasExtra = extraProductData[item.name] !== undefined;

        const productHTML = `
          <div class="product-card">
            ${item.image ? `<img src="${item.image}" alt="${item.name}" class="product-image" />` : ''}
            <h3 class="product-name" title="${item.name}">${item.name}</h3>
            <p class="product-description">${shortDesc}</p>
            ${hasExtra ? `<button class="see-more-btn" data-product-name="${item.name}">See more</button>` : ''}
            ${item.url ? `<a href="${item.url}" target="_blank" rel="noopener" class="product-link">Shop Now</a>` : ''}
          </div>
        `;
        resultsContainer.insertAdjacentHTML('beforeend', productHTML);
      });

      renderCategories();
      addSeeMoreListeners();
    }

    function renderCategories() {
      categoriesContainer.innerHTML = '';

      const allBtn = document.createElement('button');
      allBtn.textContent = 'All Categories';
      if (activeCategory === null) {
        allBtn.classList.add('active');
      }
      allBtn.addEventListener('click', () => {
        activeCategory = null;
        searchInput.value = '';
        performSearch('');
      });
      categoriesContainer.appendChild(allBtn);

      Array.from(categoriesSet).sort().forEach(cat => {
        const btn = document.createElement('button');
        btn.textContent = cat;
        if (activeCategory === cat) btn.classList.add('active');
        btn.addEventListener('click', () => {
          activeCategory = cat;
          performSearch(searchInput.value);
        });
        categoriesContainer.appendChild(btn);
      });
    }

    function performSearch(query) {
      const filters = activeCategory ? `category:"${activeCategory}"` : '';

      index.search(query, { filters })
        .then(({ hits }) => {
          categoriesSet.clear();

          if (hits.length === 0) {
            resultsContainer.innerHTML = `<p class="no-results">No results found</p>`;
            return;
          }

          renderResults(hits);
        })
        .catch(err => {
          console.error(err);
          resultsContainer.innerHTML = `<p class="no-results">Error while searching. Please try again.</p>`;
        });
    }

    // البحث الفوري عند الكتابة
    searchInput.addEventListener('input', (e) => {
      performSearch(e.target.value);
    });

    // عرض المنتجات والقوائم مباشرة عند فتح الصفحة
    performSearch('');

    // المودال وعرض التفاصيل
    const modal = document.getElementById('product-modal');
    const modalCloseBtn = document.getElementById('modal-close');
    const modalProductName = document.getElementById('modal-product-name');
    const modalImages = document.getElementById('modal-images');
    const modalDescription = document.getElementById('modal-description');
    const modalAffiliateLink = document.getElementById('modal-affiliate-link');

    function addSeeMoreListeners() {
      const buttons = document.querySelectorAll('.see-more-btn');
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          const productName = btn.getAttribute('data-product-name');
          openModal(productName);
        });
      });
    }

    function openModal(productName) {
      const productData = extraProductData[productName];
      if (!productData) return;

      modalProductName.textContent = productName;

      // عرض الصور الإضافية
      modalImages.innerHTML = '';
      productData.extraImages.forEach(src => {
        const img = document.createElement('img');
        img.src = src;
        img.alt = productName + " additional image";
        modalImages.appendChild(img);
      });

      // عرض الوصف الكامل
      modalDescription.textContent = productData.fullDescription;

      // رابط الأفلييت
      modalAffiliateLink.href = productData.affiliateLink;

      // إظهار المودال
      modal.style.display = 'flex';
      modal.classList.add('show');
      document.body.style.overflow = 'hidden'; // منع تمرير الصفحة تحت المودال
    }

    modalCloseBtn.addEventListener('click', () => {
      modal.style.display = 'none';
      modal.classList.remove('show');
      document.body.style.overflow = '';
    });

    // إغلاق المودال بالنقر خارج المحتوى
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.style.display = 'none';
        modal.classList.remove('show');
        document.body.style.overflow = '';
      }
    });

  </script>
</body>
</html>
