<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Discover - Bloom & Rise</title>
  <link href="https://fonts.googleapis.com/css2?family=Alice&family=Lora:wght@300;400&display=swap" rel="stylesheet" />
  <style>
    body {
      background-color: #1A2421;
      color: #fff8d2;
      font-family: 'Lora', serif;
      padding: 60px 20px 40px;
      text-align: center;
      min-height: 100vh;
      margin: 0;
      position: relative;
    }

    .brand-name-discover {
      font-family: 'Alice', serif;
      font-size: 40px;
      color: #d4af37;
      letter-spacing: 4px;
      margin: 15px 0 60px;
    }

    /* زر الرجوع الذهبي */
    .back-button {
      position: absolute;
      top: 15px;
      left: 20px;
      font-size: 25px;
      color: #d4af37;
      text-shadow:
        0 0 8px #f5d061,
        0 0 15px #d4af37,
        0 0 20px #f5d061;
      text-decoration: none;
      background: none;
      padding: 0;
      border: none;
      cursor: pointer;
      user-select: none;
      transition: transform 0.15s ease, color 0.15s ease, text-shadow 0.3s ease;
      display: inline-block;
      z-index: 10;
    }
    .back-button:hover {
      transform: scale(1.1);
      text-shadow:
        0 0 12px #f5d061,
        0 0 20px #d4af37,
        0 0 30px #f5d061;
      color: #f5d061;
    }
    .back-button:active {
      transform: scale(0.85);
      color: #d4af37;
      text-shadow:
        0 0 10px #d4af37,
        0 0 15px #f5d061;
    }

    /* Disclosure toggle (نجمة التصريح) */
    .disclosure-toggle {
      position: absolute;
      top: 15px;
      right: 18px;
      width: 24px;
      height: 24px;
      background-color: transparent;
      border: none;
      cursor: pointer;
      z-index: 10;
      animation: floatUpDown 2s infinite ease-in-out;
    }
    .disclosure-toggle::before {
      content: "ℬ";
      font-size: 22px;
      color: #ffffff;
      text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
      display: block;
      transition: transform 0.3s ease, text-shadow 0.3s ease;
    }
    .disclosure-toggle:hover::before {
      transform: scale(1.1);
      text-shadow: 0 0 12px rgba(255, 255, 255, 1);
    }

    @keyframes floatUpDown {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-2px);
      }
    }

    /* Disclosure text */
    .disclosure-text {
      max-width: 700px;
      margin: 100px auto 0;
      font-size: 15px;
      color: #fff8d2;
      background-color: rgba(0, 0, 0, 0.25);
      padding: 15px 20px;
      border-radius: 12px;
      line-height: 1.6;
      box-shadow: 0 0 15px rgba(212, 175, 55, 0.8);
      display: none;
      user-select: text;
      text-align: right;
      direction: ltr;
    }

    /* Search bar */
    .search-bar {
      max-width: 400px;
      margin: 0 auto 25px;
    }
    .search-wrapper {
      position: relative;
    }
    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      fill: #d4af37;
      width: 20px;
      height: 20px;
    }
    .search-wrapper input {
      width: 100%;
      padding: 10px 20px 10px 40px; /* space for icon */
      border-radius: 25px;
      border: 2px solid #1a422b; /* أخضر غامق */
      background-color: #1A2421;
      color: #fff8d2;
      font-size: 16px;
      font-family: 'Lora', serif;
      transition: box-shadow 0.3s ease, border-color 0.3s ease;
    }
    .search-wrapper input::placeholder {
      color: #1a422baa; /* أخضر شفاف */
    }
    .search-wrapper input:focus {
      outline: none;
      box-shadow: 0 0 10px 2px #1a422bcc; /* ظل أخضر */
      border-color: #f5d061; /* ذهبي */
    }

    /* Categories */
    .categories {
      margin-bottom: 30px;
    }
    .categories button {
      background: linear-gradient(135deg, #f5d061, #d4af37);
      color: #1A2421;
      font-family: 'Alice', serif;
      padding: 10px 20px;
      margin: 5px;
      border: none;
      border-radius: 20px;
      font-size: 14px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.3s;
    }
    .categories button:hover,
    .categories button.active {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.8);
    }

    /* Results grid */
    .results {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
      gap: 25px;
      max-width: 900px;
      margin: 0 auto;
      text-align: left;
    }
    .product-card {
      background: rgba(212, 175, 55, 0.1);
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
      transition: transform 0.2s;
    }
    .product-card:hover {
      transform: scale(1.03);
      box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
    }
    .product-image {
      width: 100%;
      height: 160px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 10px;
    }
    .product-name {
      font-family: 'Alice', serif;
      font-size: 18px;
      color: #d4af37;
      margin: 0 0 8px 0;
    }
    .product-description {
      font-size: 14px;
      color: #fff8d2cc;
      margin-bottom: 10px;
    }
    .product-link {
      display: inline-block;
      background-color: #d4af37;
      color: #1a1a1a;
      padding: 8px 15px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      font-family: 'Alice', serif;
      transition: background-color 0.3s;
    }
    .product-link:hover {
      background-color: #b58d2b;
    }

    /* No results */
    .no-results {
      font-size: 18px;
      color: #f5d061cc;
      margin-top: 50px;
    }

    /* Responsive for mobile */
    @media (max-width: 768px) {
      .search-bar {
        max-width: 90%;
        margin-bottom: 20px;
      }
      .search-wrapper input {
        font-size: 18px;
        padding: 12px 22px 12px 45px;
      }
      .search-icon {
        width: 22px;
        height: 22px;
        left: 15px;
      }
      .brand-name-discover {
        font-size: 28px;
        letter-spacing: 2.5px;
        margin: 20px 0 40px;
      }
    }

    /* Accessibility helper */
    .visually-hidden {
      position: absolute !important;
      height: 1px; 
      width: 1px; 
      overflow: hidden;
      clip: rect(1px, 1px, 1px, 1px);
      white-space: nowrap;
    }
  </style>
</head>
<body>

  <!-- زر الرجوع -->
  <a href="index.html" class="back-button" aria-label="Back to home">←</a>

  <!-- نجمة disclosure -->
  <button class="disclosure-toggle" 
          aria-expanded="false" 
          aria-controls="disclosure-text" 
          aria-label="Show Amazon Disclosure">
  </button>

  <!-- نص الإفصاح -->
  <div id="disclosure-text" class="disclosure-text" role="region" aria-live="polite">
    Some links on this site are affiliate links, which means we may earn a commission if you make a purchase through them, at no extra cost to you. We carefully select and recommend only products we trust.
  </div>

  <h1 class="brand-name-discover">B L O O M & R I S E</h1>

  <!-- Search bar -->
  <div class="search-bar">
    <label for="search-input" class="visually-hidden">Search products</label>
    <div class="search-wrapper">
      <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M10 2a8 8 0 105.293 14.293l4.707 4.707 1.414-1.414-4.707-4.707A8 8 0 0010 2zm0 2a6 6 0 110 12 6 6 0 010-12z"/>
      </svg>
      <input type="search" id="search-input" placeholder="Search for a product..." autocomplete="off" />
    </div>
  </div>

  <!-- Categories -->
  <div class="categories" role="list" aria-label="Product categories">
    <!-- Buttons added dynamically -->
  </div>

  <!-- Results -->
  <div class="results" aria-live="polite" aria-atomic="true">
    <!-- Products will appear here -->
  </div>

  <script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch.umd.min.js"></script>

  <script>
    const toggle = document.querySelector('.disclosure-toggle');
    const text = document.getElementById('disclosure-text');

    toggle.addEventListener('mouseenter', () => {
      text.style.display = 'block';
    });

    toggle.addEventListener('mouseleave', () => {
      text.style.display = 'none';
    });

    const APPLICATION_ID = "86N2D6VM5Z";
    const SEARCH_ONLY_API_KEY = "098e6699938861e039baa664b8ce4ef1";
    const INDEX_NAME = "products";

    const client = algoliasearch(APPLICATION_ID, SEARCH_ONLY_API_KEY);
    const index = client.initIndex(INDEX_NAME);

    let categoriesSet = new Set();
    const searchInput = document.getElementById('search-input');
    const categoriesContainer = document.querySelector('.categories');
    const resultsContainer = document.querySelector('.results');
    let activeCategory = null;

    function renderResults(hits) {
      resultsContainer.innerHTML = '';

      if (hits.length === 0) {
        resultsContainer.innerHTML = `<p class="no-results">No results found</p>`;
        return;
      }

      hits.forEach(item => {
        if (item.category) categoriesSet.add(item.category);

        const productHTML = `
          <div class="product-card">
            ${item.image ? `<img src="${item.image}" alt="${item.name}" class="product-image" />` : ''}
            <h3 class="product-name">${item.name}</h3>
            <p class="product-description">${item.description || ''}</p>
            ${item.url ? `<a href="${item.url}" target="_blank" rel="noopener" class="product-link">Shop Now</a>` : ''}
          </div>
        `;
        resultsContainer.insertAdjacentHTML('beforeend', productHTML);
      });

      renderCategories();
    }

    function renderCategories() {
      categoriesContainer.innerHTML = '';

      const allBtn = document.createElement('button');
      allBtn.textContent = 'All Categories';
      if (activeCategory === null) {
        allBtn.classList.add('active');
      }
      allBtn.addEventListener('click', () => {
        activeCategory = null;
        searchInput.value = '';
        performSearch('');
      });
      categoriesContainer.appendChild(allBtn);

      Array.from(categoriesSet).sort().forEach(cat => {
        const btn = document.createElement('button');
        btn.textContent = cat;
        if (activeCategory === cat) btn.classList.add('active');
        btn.addEventListener('click', () => {
          activeCategory = cat;
          performSearch(searchInput.value);
        });
        categoriesContainer.appendChild(btn);
      });
    }

function performSearch(query) {
  const filters = activeCategory ? `category:"${activeCategory}"` : '';

  index.search(query, { filters })
    .then(({ hits }) => {
      categoriesSet.clear();

      // عرض رسالة "لا توجد نتائج" فقط إذا المستخدم كتب شيء
      if (hits.length === 0 && query.trim() !== '') {
        resultsContainer.innerHTML = `<p class="no-results">No results found</p>`;
        return;
      }

      renderResults(hits);
    })
    .catch(err => {
      console.error(err);
      resultsContainer.innerHTML = `<p class="no-results">Error while searching. Please try again.</p>`;
    });
}

// إزالة البحث الفارغ عند التحميل
// performSearch('');


    searchInput.addEventListener('input', (e) => {
      performSearch(e.target.value);
    });

    performSearch('');
  </script>
</body>
</html>
